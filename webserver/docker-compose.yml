version: "3.5"

networks:
  image-db-net:
    external:
      name: image-db-net
#  traefik:
#    external:
#      name: traefik_web

volumes:
  # Webroot
  webroot-bind:
    driver: local
    driver_opts:
      type: none
      device: ${WEBROOT?You need to specify env WEBROOT, e.g. WEBROOT=/home/anders/projekt/labdesign/webserver}
      o: bind

services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: labdesign
    ports:
      - 8095:8080
    restart: always
    labels:
      - traefik.enable=true
      - traefik.docker.network=traefik_web
      - traefik.backend=web
      - traefik.frontend.rule=Host:labdesign-dev.pharmb.io
      - traefik.frontend.auth.basic=pharmbio:$$2y$$05$$RdRhskrhXJijo0FUKfVIT.E7Q2kH2Bf0BZ.1KYYcy4R9Piat/DiUK
      - traefik.port=8080
    networks:
      - image-db-net
#      - traefik
    volumes:
      - webroot-bind:/app
